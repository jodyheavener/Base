"use strict";var _get=function a(b,c,d){var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e&&e.writable)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},_inherits=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},_classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.observe||function(a,b,c){var d,e,f=["add","update","delete","reconfigure","setPrototype","preventExtensions"],g=b.isArray||function(a){return function(b){return"[object Array]"===a.call(b)}}(a.prototype.toString),h=b.prototype.indexOf?b.indexOf||function(a,c,d){return b.prototype.indexOf.call(a,c,d)}:function(a,b,c){for(var d=c||0;d<a.length;d++)if(a[d]===b)return d;return-1},i="undefined"!=typeof c.Map&&Map.prototype.forEach?function(){return new Map}:function(){var a=[],b=[];return{size:0,has:function(b){return h(a,b)>-1},get:function(c){return b[h(a,c)]},set:function(c,d){var e=h(a,c);-1===e?(a.push(c),b.push(d),this.size++):b[e]=d},"delete":function(c){var d=h(a,c);d>-1&&(a.splice(d,1),b.splice(d,1),this.size--)},forEach:function(c){for(var d=0;d<a.length;d++)c.call(arguments[1],b[d],a[d],this)}}},j=a.getOwnPropertyNames?function(){var b=a.getOwnPropertyNames;try{arguments.callee}catch(c){var d=(b(h).join(" ")+" ").replace(/prototype |length |name /g,"").slice(0,-1).split(" ");d.length&&(b=function(b){var c=a.getOwnPropertyNames(b);if("function"==typeof b)for(var e,f=0;f<d.length;)(e=h(c,d[f++]))>-1&&c.splice(e,1);return c})}return b}():function(b){var c,d,e=[];if("hasOwnProperty"in b)for(c in b)b.hasOwnProperty(c)&&e.push(c);else{d=a.hasOwnProperty;for(c in b)d.call(b,c)&&e.push(c)}return g(b)&&e.push("length"),e},k=a.getPrototypeOf,l=a.defineProperties&&a.getOwnPropertyDescriptor,m=c.requestAnimationFrame||c.webkitRequestAnimationFrame||function(){var a=+new Date,b=a;return function(c){+new Date;return setTimeout(function(){c((b=+new Date)-a)},17)}}(),n=function(a,b,c){var e=d.get(a);e?t(a,e,b,c):(e=o(a),t(a,e,b,c),1===d.size&&m(q))},o=function(b,c){var e,f=j(b),g=[],h=0,c={handlers:i(),frozen:a.isFrozen?a.isFrozen(b):!1,extensible:a.isExtensible?a.isExtensible(b):!0,proto:k&&k(b),properties:f,values:g,notifier:s(b,c)};if(l)for(e=c.descriptors=[];h<f.length;)e[h]=l(b,f[h]),g[h]=b[f[h++]];else for(;h<f.length;)g[h]=b[f[h++]];return d.set(b,c),c},p=function(){var b=l?function(a,b,c,d,e){var f=b.properties[c],g=a[f],h=b.values[c],i=b.descriptors[c];"value"in e&&(h===g?0===h&&1/h!==1/g:h===h||g===g)&&(u(a,b,{name:f,type:"update",object:a,oldValue:h},d),b.values[c]=g),!i.configurable||e.configurable&&e.writable===i.writable&&e.enumerable===i.enumerable&&e.get===i.get&&e.set===i.set||(u(a,b,{name:f,type:"reconfigure",object:a,oldValue:h},d),b.descriptors[c]=e)}:function(a,b,c,d){var e=b.properties[c],f=a[e],g=b.values[c];(g===f?0===g&&1/g!==1/f:g===g||f===f)&&(u(a,b,{name:e,type:"update",object:a,oldValue:g},d),b.values[c]=f)},c=l?function(a,c,d,e,f){for(var g,h=c.length;d&&h--;)null!==c[h]&&(g=l(a,c[h]),d--,g?b(a,e,h,f,g):(u(a,e,{name:c[h],type:"delete",object:a,oldValue:e.values[h]},f),e.properties.splice(h,1),e.values.splice(h,1),e.descriptors.splice(h,1)))}:function(a,b,c,d,e){for(var f=b.length;c&&f--;)null!==b[f]&&(u(a,d,{name:b[f],type:"delete",object:a,oldValue:d.values[f]},e),d.properties.splice(f,1),d.values.splice(f,1),c--)};return function(d,e,f){if(d.handlers.size&&!d.frozen){var g,i,m,n,o,p,q,r,s=d.values,t=d.descriptors,v=0;if(d.extensible)if(g=d.properties.slice(),i=g.length,m=j(e),t){for(;v<m.length;)o=m[v++],n=h(g,o),r=l(e,o),-1===n?(u(e,d,{name:o,type:"add",object:e},f),d.properties.push(o),s.push(e[o]),t.push(r)):(g[n]=null,i--,b(e,d,n,f,r));c(e,g,i,d,f),a.isExtensible(e)||(d.extensible=!1,u(e,d,{type:"preventExtensions",object:e},f),d.frozen=a.isFrozen(e))}else{for(;v<m.length;)o=m[v++],n=h(g,o),p=e[o],-1===n?(u(e,d,{name:o,type:"add",object:e},f),d.properties.push(o),s.push(p)):(g[n]=null,i--,b(e,d,n,f));c(e,g,i,d,f)}else if(!d.frozen){for(;v<g.length;v++)o=g[v],b(e,d,v,f,l(e,o));a.isFrozen(e)&&(d.frozen=!0)}k&&(q=k(e),q!==d.proto&&(u(e,d,{type:"setPrototype",name:"__proto__",object:e,oldValue:d.proto}),d.proto=q))}}}(),q=function(a){var b=function(){return a.apply(this,arguments)};return b.toString=function(){return a.toString()},b}(function(){d.size&&(d.forEach(p),e.forEach(r),m(q))}),r=function(a,b){a.changeRecords.length&&(b(a.changeRecords),a.changeRecords=[])},s=function(a,b){return arguments.length<2&&(b=d.get(a)),b&&b.notifier||{notify:function(b){b.type;var c=d.get(a);if(c){var e,f={object:a};for(e in b)"object"!==e&&(f[e]=b[e]);u(a,c,f)}},performChange:function(b,c){if("string"!=typeof b)throw new TypeError("Invalid non-string changeType");if("function"!=typeof c)throw new TypeError("Cannot perform non-function");var e,f,g=d.get(a),h=c.call(arguments[2]);if(g&&p(g,a,b),g&&h&&"object"==typeof h){f={object:a,type:b};for(e in h)"object"!==e&&"type"!==e&&(f[e]=h[e]);u(a,g,f)}}}},t=function(a,b,c,d){var f=e.get(c);f||e.set(c,f={observed:i(),changeRecords:[]}),f.observed.set(a,{acceptList:d.slice(),data:b}),b.handlers.set(c,f)},u=function(a,b,c,d){b.handlers.forEach(function(b){var e=b.observed.get(a).acceptList;("string"!=typeof d||-1===h(e,d))&&h(e,c.type)>-1&&b.changeRecords.push(c)})};d=i(),e=i(),a.observe=function(b,c,d){if(!b||"object"!=typeof b&&"function"!=typeof b)throw new TypeError("Object.observe cannot observe non-object");if("function"!=typeof c)throw new TypeError("Object.observe cannot deliver to non-function");if(a.isFrozen&&a.isFrozen(c))throw new TypeError("Object.observe cannot deliver to a frozen function object");if(arguments.length>2){if(!d||"object"!=typeof d)throw new TypeError("Object.observe cannot use non-object accept list")}else d=f;return n(b,c,d),b},a.unobserve=function(a,b){if(null===a||"object"!=typeof a&&"function"!=typeof a)throw new TypeError("Object.unobserve cannot unobserve non-object");if("function"!=typeof b)throw new TypeError("Object.unobserve cannot deliver to non-function");var c,f=e.get(b);return f&&(c=f.observed.get(a))&&(f.observed.forEach(function(a,b){p(a.data,b)}),m(function(){r(f,b)}),1===f.observed.size&&f.observed.has(a)?e["delete"](b):f.observed["delete"](a),1===c.data.handlers.size?d["delete"](a):c.data.handlers["delete"](b)),a},a.getNotifier=function(b){if(null===b||"object"!=typeof b&&"function"!=typeof b)throw new TypeError("Object.getNotifier cannot getNotifier non-object");return a.isFrozen&&a.isFrozen(b)?null:s(b)},a.deliverChangeRecords=function(a){if("function"!=typeof a)throw new TypeError("Object.deliverChangeRecords cannot deliver to non-function");var b=e.get(a);b&&(b.observed.forEach(function(a,b){p(a.data,b)}),r(b,a))}}(Object,Array,void 0);var Base=function(){var a=function(b){var c=this;_classCallCheck(this,a),this.BASE_VERSION="0.0.2","object"==typeof b&&Object.keys(b).forEach(function(a){c[a]=b[a]})};return a}();Base.prototype._={},Base.prototype._.dataRoute=function(parameters){var tokens=void 0,route="";return tokens=String(parameters.route).split(" "),tokens.forEach(function(a){route=route+'["'+a+'"]'}),route=route.replace(/:([0-9])"/g,'"][$1'),eval("parameters.target"+route)},Base.prototype._.domParser=new DOMParser,Base.prototype._.domEvents=Object.getOwnPropertyNames(document).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(Object.getPrototypeOf(document)))).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(window))).filter(function(a){return!a.indexOf("on")&&(null==document[a]||"function"==typeof document[a])}).filter(function(a,b,c){return c.indexOf(a)==b}),Base.prototype._.forElements=function(a){a.elements.length||(a.elements=[a.elements]),[].forEach.call(a.elements,function(b){a.execute(b)})},Base.Class=function(){var a=function(b){var c=this;_classCallCheck(this,a),Object.keys(b).forEach(function(a){c[a]=b[a]})};return a}(),Base.Class.prototype.instanceEvents={},Base.Class.prototype.hasElement=function(){return this.element&&this.element instanceof HTMLElement},Base.Class.prototype.delegateEvents=function(){var a=this;this.events&&Object.keys(this.events).forEach(function(b){var c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;c=b.substr(0,b.indexOf(" ")),d=a.element,e=a.events[b],f=a.events[b].substr(0,a.events[b].indexOf(" ")),c.length?(g=b.substr(b.indexOf(" ")+1),d=d.querySelectorAll(b.substr(b.indexOf(" ")+1))):c=b,h=a,f.length&&(e=a.events[b].substr(0,a.events[b].indexOf(" ")),h=a[a.events[b].substr(a.events[b].indexOf(" ")+1)]),a.hasElement&&-1!==Base.prototype._.domEvents.indexOf("on"+c)?Base.prototype._.forElements.call(a,{elements:d,execute:function(a){a.addEventListener(c,function(a){h[e].apply(h,[a,a.detail])})}}):a.instanceEvents[c]=h[e]})},Base.Class.prototype.undelegateEvents=function(){var a=this;this.events&&Object.keys(this.events).forEach(function(b){var c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;c=b.substr(0,b.indexOf(" ")),d=a.element,e=a.events[b],f=a.events[b].substr(0,a.events[b].indexOf(" ")),c.length?(g=b.substr(b.indexOf(" ")+1),d=d.querySelectorAll(b.substr(b.indexOf(" ")+1))):c=b,h=a,f.length&&(e=a.events[b].substr(0,a.events[b].indexOf(" ")),h=a[a.events[b].substr(a.events[b].indexOf(" ")+1)]),a.hasElement&&-1!==Base.prototype._.domEvents.indexOf("on"+c)?Base.prototype._.forElements.call(a,{elements:d,execute:function(a){a.removeEventListener(c,function(a){h[e].apply(h,[a,a.detail])})}}):a.instanceEvents[c]=null})},Base.Class.prototype.trigger=function(a){if(this.events){var b=a.name||a;if(this.hasElement&&-1!==Base.prototype._.domEvents.indexOf("on"+b)){var c=void 0;window.CustomEvent?c=new CustomEvent(b,{detail:a.data}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(b,!0,!0,a.data)),this.element.dispatchEvent(c)}else this.instanceEvents[b].call(this,a.data)}},Base.prototype.views={},Base.View=function(a){var b=function(a){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a),this.id=this.id||Object.keys(Base.prototype.views).length+1,Base.prototype.views[this.id]=this,this.element&&this.setupView()};return _inherits(b,a),b}(Base.Class),Base.View.prototype.setupView=function(){this.element.setAttribute("data-view",this.id),this.delegateEvents(),this.initialize&&this.initialize()},Base.View.prototype.render=function(a){var b=void 0,c=void 0;return c=a.template?"function"==typeof a.template?a.template(a.data):a.template:"function"==typeof this.template?this.template(a.data):this.template,b=Base.prototype._.domParser.parseFromString(this.template,"text/xml"),this.element=b.children[0],this.setupView(),a.callback&&a.callback(),this.element},Base.View.prototype.destroy=function(a){var b=void 0,c=void 0;b=function(){null!=this.element&&this.element.removeAttribute("data-view"),this.undelegateEvents(),Base.prototype.views[this.id]=null},c=function(a){this.element.parentNode.removeChild(this.element),this.element=void 0,null!=a&&a.call(this)},null==a||a!==!0&&a.removeElement!==!0?b.call(this):c.apply(this,[function(){b.call(this)}])},Base.prototype.sets={},Base.Set=function(a){var b=function(a){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a),this.id=this.id||Object.keys(Base.prototype.sets).length+1,Base.prototype.sets[this.id]=this,this.data={},this.initialize&&this.initialize()};return _inherits(b,a),b}(Base.Class),Base.Set.prototype.typeTests={string:function(a){return"string"==typeof a||a instanceof String},number:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},array:function(a){return a.constructor===Array},object:function(a){return"object"==typeof a},url:function(a){var b=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return b.test(a)?!0:!1},timestamp:function(a){return new Date(a).getTime()>0}},Base.Set.prototype.addType=function(a){this.typeTests[a.type]=a.test},Base.Set.prototype.isType=function(a){return"function"==typeof a.type?a.type(a.value):this.typeTests[a.type](a.value)},Base.Set.prototype.add=function(a){var b=this,c=void 0,d=a.data||a;c=function(a,c,e){var f=Base.prototype._.dataRoute({target:d,route:c});return b.isType({type:e,value:f})?(b.data[a]=f,!0):!1},Object.keys(this.schema).forEach(function(a){var d=!1,e=b.schema[a];return"string"==typeof e.use?d||(d=c(a,e.use,e.type)):e.use.forEach(function(b){d||(d=c(a,b,e.type))}),!d&&e.fail?b.data[a]="function"==typeof e.fail?e.fail():e.fail:void 0})},Base.Set.prototype.get=function(a){var b=a.route||a;return Base.prototype._.dataRoute({target:this.data,route:b})},Base.Store=function(a){var b=function(a){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a),this.delegateEvents(),this.observeSets(),this.initialize&&this.initialize()};return _inherits(b,a),b}(Base.Class),Base.Store.prototype.observeSets=function(){var a=this,b={};Object.keys(this).forEach(function(c){a[c]instanceof Base.Set&&(b[c]=a[c])}),Object.keys(b).forEach(function(c){Object.observe(b[c].data,function(d){a.changeObservation.call(a,{events:d,set:b[c]})})})},Base.Store.prototype.changeObservation=function(a){var b=this;a.events.forEach(function(c){b.trigger({name:c.type,parameters:{change:c,set:a.set}})})};